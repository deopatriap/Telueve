FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
# Install build tools for native modules, run npm ci, then remove build deps to keep image small
RUN apk add --no-cache --virtual .gyp python3 make g++ \
	&& npm install --unsafe-perm \
	&& apk del .gyp
COPY . .
EXPOSE 5000 50051
CMD ["npm", "run", "dev"]
